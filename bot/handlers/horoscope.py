"""
–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≥–æ—Ä–æ—Å–∫–æ–ø–æ–≤
"""

from aiogram import Router, types, F
from aiogram.filters import Command
from aiogram.fsm.context import FSMContext
from aiogram.fsm.state import State, StatesGroup
from aiogram.types import Message, CallbackQuery
from aiogram.utils.keyboard import InlineKeyboardBuilder
from datetime import datetime

router = Router()


# –ó–Ω–∞–∫–∏ –∑–æ–¥–∏–∞–∫–∞
ZODIAC_SIGNS = {
    "aries": {"name": "‚ôàÔ∏è –û–≤–µ–Ω", "dates": "21.03 - 19.04"},
    "taurus": {"name": "‚ôâÔ∏è –¢–µ–ª–µ—Ü", "dates": "20.04 - 20.05"},
    "gemini": {"name": "‚ôäÔ∏è –ë–ª–∏–∑–Ω–µ—Ü—ã", "dates": "21.05 - 20.06"},
    "cancer": {"name": "‚ôãÔ∏è –†–∞–∫", "dates": "21.06 - 22.07"},
    "leo": {"name": "‚ôåÔ∏è –õ–µ–≤", "dates": "23.07 - 22.08"},
    "virgo": {"name": "‚ôçÔ∏è –î–µ–≤–∞", "dates": "23.08 - 22.09"},
    "libra": {"name": "‚ôéÔ∏è –í–µ—Å—ã", "dates": "23.09 - 22.10"},
    "scorpio": {"name": "‚ôèÔ∏è –°–∫–æ—Ä–ø–∏–æ–Ω", "dates": "23.10 - 21.11"},
    "sagittarius": {"name": "‚ôêÔ∏è –°—Ç—Ä–µ–ª–µ—Ü", "dates": "22.11 - 21.12"},
    "capricorn": {"name": "‚ôëÔ∏è –ö–æ–∑–µ—Ä–æ–≥", "dates": "22.12 - 19.01"},
    "aquarius": {"name": "‚ôíÔ∏è –í–æ–¥–æ–ª–µ–π", "dates": "20.01 - 18.02"},
    "pisces": {"name": "‚ôìÔ∏è –†—ã–±—ã", "dates": "19.02 - 20.03"},
}


@router.message(Command("horoscope"))
async def cmd_horoscope(message: Message):
    """–ö–æ–º–∞–Ω–¥–∞ /horoscope - –≤—ã–±–æ—Ä –∑–Ω–∞–∫–∞ –∑–æ–¥–∏–∞–∫–∞"""
    text = """
‚ôàÔ∏è *–ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ —Å–µ–≥–æ–¥–Ω—è*

–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –∑–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞:

*–û–≥–Ω–µ–Ω–Ω—ã–µ:* ‚ôàÔ∏è –û–≤–µ–Ω, ‚ôåÔ∏è –õ–µ–≤, ‚ôêÔ∏è –°—Ç—Ä–µ–ª–µ—Ü
*–ó–µ–º–Ω—ã–µ:* ‚ôâÔ∏è –¢–µ–ª–µ—Ü, ‚ôçÔ∏è –î–µ–≤–∞, ‚ôëÔ∏è –ö–æ–∑–µ—Ä–æ–≥
*–í–æ–∑–¥—É—à–Ω—ã–µ:* ‚ôäÔ∏è –ë–ª–∏–∑–Ω–µ—Ü—ã, ‚ôéÔ∏è –í–µ—Å—ã, ‚ôíÔ∏è –í–æ–¥–æ–ª–µ–π
*–í–æ–¥–Ω—ã–µ:* ‚ôãÔ∏è –†–∞–∫, ‚ôèÔ∏è –°–∫–æ—Ä–ø–∏–æ–Ω, ‚ôìÔ∏è –†—ã–±—ã

–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É —Å–≤–æ–µ–≥–æ —Ä–æ–∂–¥–µ–Ω–∏—è (–î–î.–ú–ú), —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–Ω–∞–∫.
"""
    
    builder = InlineKeyboardBuilder()
    
    # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—Å–µ—Ö –∑–Ω–∞–∫–æ–≤ –∑–æ–¥–∏–∞–∫–∞
    for sign_key, sign_data in ZODIAC_SIGNS.items():
        builder.add(types.InlineKeyboardButton(
            text=sign_data["name"],
            callback_data=f"horoscope_{sign_key}"
        ))
    
    builder.adjust(3)  # 3 –∫–Ω–æ–ø–∫–∏ –≤ —Ä—è–¥
    
    await message.answer(text, reply_markup=builder.as_markup(), parse_mode="Markdown")


@router.callback_query(lambda c: c.data.startswith("horoscope_") 
                         and not c.data.startswith("horoscope_week_")
                         and not c.data.startswith("horoscope_month_")
                         and not c.data.startswith("horoscope_compat_")
                         and c.data != "horoscope_other")
async def process_zodiac_sign(callback: CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∑–Ω–∞–∫–∞ –∑–æ–¥–∏–∞–∫–∞"""
    sign_key = callback.data.replace("horoscope_", "")
    sign_data = ZODIAC_SIGNS.get(sign_key)
    
    if not sign_data:
        await callback.answer("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∑–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞")
        return
    
    sign_name = sign_data["name"]
    sign_dates = sign_data["dates"]
    
    # –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –≥–æ—Ä–æ—Å–∫–æ–ø–∞ –∏–∑ API –∏–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    # –ü–æ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–≥–ª—É—à–∫—É —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–µ–∫—Å—Ç–∞–º–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤
    
    horoscope_texts = {
        "aries": """
üî• *‚ôàÔ∏è –û–í–ï–ù ‚Äî –ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ —Å–µ–≥–æ–¥–Ω—è*

*–û–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑:* –ú–∞—Ä—Å –¥–∞—ë—Ç –≤–∞–º —ç–Ω–µ—Ä–≥–∏—é –¥–ª—è –Ω–æ–≤—ã—Ö –Ω–∞—á–∏–Ω–∞–Ω–∏–π. –°–µ–≥–æ–¥–Ω—è –∏–¥–µ–∞–ª—å–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤.

*–õ—é–±–æ–≤—å:* –í—Å—Ç—Ä–µ—á–∞ —Å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏ –≤ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–º –º–µ—Å—Ç–µ.
*–ö–∞—Ä—å–µ—Ä–∞:* –ö–æ–ª–ª–µ–≥–∏ –æ—Ü–µ–Ω—è—Ç –≤–∞—à—É –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É. –ù–µ –±–æ–π—Ç–µ—Å—å –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –Ω–æ–≤—ã–µ –∏–¥–µ–∏.
*–§–∏–Ω–∞–Ω—Å—ã:* –í–æ–∑–º–æ–∂–Ω–∞ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –ø—Ä–µ–º–∏—è –∏–ª–∏ –≤—ã–≥–æ–¥–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ.
*–ó–¥–æ—Ä–æ–≤—å–µ:* –ë–µ—Ä–µ–≥–∏—Ç–µ —ç–Ω–µ—Ä–≥–∏—é ‚Äî –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–π—Ç–µ —Å–µ–±—è.

*–°–æ–≤–µ—Ç –¥–Ω—è:* –î–µ–π—Å—Ç–≤—É–π—Ç–µ —Å–º–µ–ª–æ, –Ω–æ –ø—Ä–æ–¥—É–º–∞–Ω–Ω–æ.
*–°—á–∞—Å—Ç–ª–∏–≤–æ–µ —á–∏—Å–ª–æ:* 7
*–°—á–∞—Å—Ç–ª–∏–≤—ã–π —Ü–≤–µ—Ç:* –ö—Ä–∞—Å–Ω—ã–π
""",
        "taurus": """
üåø *‚ôâÔ∏è –¢–ï–õ–ï–¶ ‚Äî –ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ —Å–µ–≥–æ–¥–Ω—è*

*–û–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑:* –í–µ–Ω–µ—Ä–∞ –ø—Ä–∏–Ω–æ—Å–∏—Ç –≥–∞—Ä–º–æ–Ω–∏—é –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è. –°–µ–≥–æ–¥–Ω—è —Å—Ç–æ–∏—Ç —É–¥–µ–ª–∏—Ç—å –≤—Ä–µ–º—è –±–ª–∏–∑–∫–∏–º.

*–õ—é–±–æ–≤—å:* –†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π —É–∂–∏–Ω –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ–π —Ä–∞–∑–≥–æ–≤–æ—Ä –ø–æ –¥—É—à–∞–º —É–∫—Ä–µ–ø–∏—Ç —Å–≤—è–∑—å.
*–ö–∞—Ä—å–µ—Ä–∞:* –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –ø–ª–∞–Ω–æ–º–µ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø—Ä–∏–Ω–µ—Å—É—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.
*–§–∏–Ω–∞–Ω—Å—ã:* –•–æ—Ä–æ—à–∏–π –¥–µ–Ω—å –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±—é–¥–∂–µ—Ç–∞ –∏ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö –≤–ª–æ–∂–µ–Ω–∏–π.
*–ó–¥–æ—Ä–æ–≤—å–µ:* –ü—Ä–æ–≥—É–ª–∫–∞ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ –ø–æ–º–æ–∂–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–∏–ª—ã.

*–°–æ–≤–µ—Ç –¥–Ω—è:* –¶–µ–Ω–∏—Ç–µ —Ç–æ, —á—Ç–æ –∏–º–µ–µ—Ç–µ.
*–°—á–∞—Å—Ç–ª–∏–≤–æ–µ —á–∏—Å–ª–æ:* 6
*–°—á–∞—Å—Ç–ª–∏–≤—ã–π —Ü–≤–µ—Ç:* –ó–µ–ª—ë–Ω—ã–π
""",
        "gemini": """
üí´ *‚ôäÔ∏è –ë–õ–ò–ó–ù–ï–¶–´ ‚Äî –ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ —Å–µ–≥–æ–¥–Ω—è*

*–û–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑:* –ú–µ—Ä–∫—É—Ä–∏–π —É—Å–∏–ª–∏–≤–∞–µ—Ç –≤–∞—à—É –∫–æ–º–º—É–Ω–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç—å. –°–µ–≥–æ–¥–Ω—è –∏–¥–µ–∞–ª—å–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤ –∏ –æ–±—É—á–µ–Ω–∏—è.

*–õ—é–±–æ–≤—å:* –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–º—É –∑–Ω–∞–∫–æ–º—Å—Ç–≤—É.
*–ö–∞—Ä—å–µ—Ä–∞:* –í–∞—à–∏ –∏–¥–µ–∏ –±—É–¥—É—Ç —É—Å–ª—ã—à–∞–Ω—ã. –ü—Ä–æ—è–≤–∏—Ç–µ –≥–∏–±–∫–æ—Å—Ç—å –≤ –æ–±—â–µ–Ω–∏–∏.
*–§–∏–Ω–∞–Ω—Å—ã:* –í–æ–∑–º–æ–∂–Ω—ã –Ω–µ–±–æ–ª—å—à–∏–µ, –Ω–æ –ø—Ä–∏—è—Ç–Ω—ã–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è.
*–ó–¥–æ—Ä–æ–≤—å–µ:* –î—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –ø–æ–º–æ–≥—É—Ç —Å–Ω—è—Ç—å —Å—Ç—Ä–µ—Å—Å.

*–°–æ–≤–µ—Ç –¥–Ω—è:* –ë—É–¥—å—Ç–µ –æ—Ç–∫—Ä—ã—Ç—ã –Ω–æ–≤—ã–º –∫–æ–Ω—Ç–∞–∫—Ç–∞–º.
*–°—á–∞—Å—Ç–ª–∏–≤–æ–µ —á–∏—Å–ª–æ:* 5
*–°—á–∞—Å—Ç–ª–∏–≤—ã–π —Ü–≤–µ—Ç:* –ñ—ë–ª—Ç—ã–π
""",
        "cancer": """
üåô *‚ôãÔ∏è –†–ê–ö ‚Äî –ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ —Å–µ–≥–æ–¥–Ω—è*

*–û–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑:* –õ—É–Ω–∞ —É—Å–∏–ª–∏–≤–∞–µ—Ç –≤–∞—à—É –∏–Ω—Ç—É–∏—Ü–∏—é. –°–µ–≥–æ–¥–Ω—è –¥–æ–≤–µ—Ä—è–π—Ç–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É –≥–æ–ª–æ—Å—É.

*–õ—é–±–æ–≤—å:* –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –±–ª–∏–∑–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ —Å–ª–æ–≤. –ü—Ä–æ—è–≤–∏—Ç–µ –∑–∞–±–æ—Ç—É –æ –±–ª–∏–∑–∫–∏—Ö.
*–ö–∞—Ä—å–µ—Ä–∞:* –†–∞–±–æ—Ç–∞ –≤ –∫–æ–º–∞–Ω–¥–µ –ø—Ä–∏–Ω–µ—Å—ë—Ç –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, —á–µ–º –≤ –æ–¥–∏–Ω–æ—á–∫—É.
*–§–∏–Ω–∞–Ω—Å—ã:* –•–æ—Ä–æ—à–∏–π –¥–µ–Ω—å –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ–º–µ–π–Ω–æ–≥–æ –±—é–¥–∂–µ—Ç–∞.
*–ó–¥–æ—Ä–æ–≤—å–µ:* –û—Ç–¥—ã—Ö –∏ –º–µ–¥–∏—Ç–∞—Ü–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤—è—Ç —ç–Ω–µ—Ä–≥–∏—é.

*–°–æ–≤–µ—Ç –¥–Ω—è:* –ü–æ–∑–≤–æ–ª—å—Ç–µ —Å–µ–±–µ –±—ã—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º.
*–°—á–∞—Å—Ç–ª–∏–≤–æ–µ —á–∏—Å–ª–æ:* 2
*–°—á–∞—Å—Ç–ª–∏–≤—ã–π —Ü–≤–µ—Ç:* –°–µ—Ä–µ–±—Ä—è–Ω—ã–π
""",
        "leo": """
ü¶Å *‚ôåÔ∏è –õ–ï–í ‚Äî –ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ —Å–µ–≥–æ–¥–Ω—è*

*–û–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑:* –°–æ–ª–Ω—Ü–µ –¥–∞—Ä–∏—Ç –≤–∞–º —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ —Ç–≤–æ—Ä—á–µ—Å–∫—É—é —ç–Ω–µ—Ä–≥–∏—é. –°–µ–≥–æ–¥–Ω—è –≤—ã –≤ —Ü–µ–Ω—Ç—Ä–µ –≤–Ω–∏–º–∞–Ω–∏—è.

*–õ—é–±–æ–≤—å:* –†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ. –ù–µ –±–æ–π—Ç–µ—Å—å –ø—Ä–æ—è–≤–∏—Ç—å –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É.
*–ö–∞—Ä—å–µ—Ä–∞:* –í–∞—à–∏ –ª–∏–¥–µ—Ä—Å–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –±—É–¥—É—Ç –∑–∞–º–µ—á–µ–Ω—ã. –í–æ–∑–º–æ–∂–µ–Ω –∫–∞—Ä—å–µ—Ä–Ω—ã–π —Ä–æ—Å—Ç.
*–§–∏–Ω–∞–Ω—Å—ã:* –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ —Å–µ–±—è –æ–∫—É–ø—è—Ç—Å—è. –ü–æ–∑–≤–æ–ª—å—Ç–µ —Å–µ–±–µ –Ω–µ–±–æ–ª—å—à—É—é —Ä–æ—Å–∫–æ—à—å.
*–ó–¥–æ—Ä–æ–≤—å–µ:* –§–∏–∑–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–≤—ã—Å–∏—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ.

*–°–æ–≤–µ—Ç –¥–Ω—è:* –°–∏—è–π—Ç–µ, –Ω–æ –Ω–µ –æ—Å–ª–µ–ø–ª—è–π—Ç–µ –¥—Ä—É–≥–∏—Ö.
*–°—á–∞—Å—Ç–ª–∏–≤–æ–µ —á–∏—Å–ª–æ:* 1
*–°—á–∞—Å—Ç–ª–∏–≤—ã–π —Ü–≤–µ—Ç:* –ó–æ–ª–æ—Ç–æ–π
""",
        "virgo": """
üåæ *‚ôçÔ∏è –î–ï–í–ê ‚Äî –ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ —Å–µ–≥–æ–¥–Ω—è*

*–û–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑:* –ú–µ—Ä–∫—É—Ä–∏–π –ø–æ–º–æ–≥–∞–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏. –°–µ–≥–æ–¥–Ω—è –æ—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

*–õ—é–±–æ–≤—å:* –ü—Ä–∞–∫—Ç–∏—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º —É–∫—Ä–µ–ø–∏—Ç —Å–≤—è–∑—å. –û–±—Å—É–¥–∏—Ç–µ –≤–∞–∂–Ω—ã–µ —Ç–µ–º—ã.
*–ö–∞—Ä—å–µ—Ä–∞:* –í–Ω–∏–º–∞–Ω–∏–µ –∫ –º–µ–ª–æ—á–∞–º –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç –æ—à–∏–±–∫–∏. –í–∞—à–∞ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –æ—Ü–µ–Ω–µ–Ω–∞.
*–§–∏–Ω–∞–Ω—Å—ã:* –•–æ—Ä–æ—à–∏–π –¥–µ–Ω—å –¥–ª—è —É—á–µ—Ç–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ –∏ –ø–æ–∏—Å–∫–∞ –≤—ã–≥–æ–¥–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π.
*–ó–¥–æ—Ä–æ–≤—å–µ:* –ó–¥–æ—Ä–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ –∏ —Ä–µ–∂–∏–º –¥–Ω—è —É–ª—É—á—à–∞—Ç —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ.

*–°–æ–≤–µ—Ç –¥–Ω—è:* –°–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤—É–π—Ç–µ, –Ω–æ –Ω–µ –ø–µ—Ä–µ—É—Å–µ—Ä–¥—Å—Ç–≤—É–π—Ç–µ.
*–°—á–∞—Å—Ç–ª–∏–≤–æ–µ —á–∏—Å–ª–æ:* 4
*–°—á–∞—Å—Ç–ª–∏–≤—ã–π —Ü–≤–µ—Ç:* –ö–æ—Ä–∏—á–Ω–µ–≤—ã–π
""",
        "libra": """
‚öñÔ∏è *‚ôéÔ∏è –í–ï–°–´ ‚Äî –ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ —Å–µ–≥–æ–¥–Ω—è*

*–û–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑:* –í–µ–Ω–µ—Ä–∞ –ø—Ä–∏–Ω–æ—Å–∏—Ç –≥–∞—Ä–º–æ–Ω–∏—é –≤ –≤–∞—à—É –∂–∏–∑–Ω—å. –°–µ–≥–æ–¥–Ω—è —Å—Ç—Ä–µ–º–∏—Ç–µ—Å—å –∫ –±–∞–ª–∞–Ω—Å—É –≤–æ –≤—Å—ë–º.

*–õ—é–±–æ–≤—å:* –†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –≤—Å—Ç—Ä–µ—á–∞ –∏–ª–∏ –ø—Ä–∏–º–∏—Ä–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Ä–∞–∑–Ω–æ–≥–ª–∞—Å–∏–π.
*–ö–∞—Ä—å–µ—Ä–∞:* –î–∏–ø–ª–æ–º–∞—Ç–∏—è –ø–æ–º–æ–∂–µ—Ç —Ä–µ—à–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç. –°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–Ω–µ—Å—ë—Ç –ø–ª–æ–¥—ã.
*–§–∏–Ω–∞–Ω—Å—ã:* –•–æ—Ä–æ—à–∏–π –¥–µ–Ω—å –¥–ª—è –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏—Ö –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –∏–ª–∏ —Å–æ–≤–º–µ—Å—Ç–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫.
*–ó–¥–æ—Ä–æ–≤—å–µ:* –ô–æ–≥–∞ –∏–ª–∏ —Ä–∞—Å—Ç—è–∂–∫–∞ –ø–æ–º–æ–≥—É—Ç –æ–±—Ä–µ—Å—Ç–∏ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ.

*–°–æ–≤–µ—Ç –¥–Ω—è:* –ò—â–∏—Ç–µ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å—ã, –Ω–æ –Ω–µ —Ç–µ—Ä—è–π—Ç–µ —Å–µ–±—è.
*–°—á–∞—Å—Ç–ª–∏–≤–æ–µ —á–∏—Å–ª–æ:* 9
*–°—á–∞—Å—Ç–ª–∏–≤—ã–π —Ü–≤–µ—Ç:* –†–æ–∑–æ–≤—ã–π
""",
        "scorpio": """
ü¶Ç *‚ôèÔ∏è –°–ö–û–†–ü–ò–û–ù ‚Äî –ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ —Å–µ–≥–æ–¥–Ω—è*

*–û–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑:* –ü–ª—É—Ç–æ–Ω —É—Å–∏–ª–∏–≤–∞–µ—Ç –≤–∞—à—É –≥–ª—É–±–∏–Ω—É –∏ –ø—Ä–æ–Ω–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –°–µ–≥–æ–¥–Ω—è –≤—ã –º–æ–∂–µ—Ç–µ —Ä–∞—Å–∫—Ä—ã—Ç—å —Ç–∞–π–Ω—ã.

*–õ—é–±–æ–≤—å:* –°—Ç—Ä–∞—Å—Ç—å –∏ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö. –ì–ª—É–±–æ–∫–∏–π —Ä–∞–∑–≥–æ–≤–æ—Ä —Å–±–ª–∏–∑–∏—Ç.
*–ö–∞—Ä—å–µ—Ä–∞:* –í–∞—à–∞ –Ω–∞—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –ø–æ–º–æ–∂–µ—Ç –ø—Ä–µ–æ–¥–æ–ª–µ—Ç—å –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è. –ù–µ –±–æ–π—Ç–µ—Å—å —Ä–∏—Å–∫–æ–≤–∞—Ç—å.
*–§–∏–Ω–∞–Ω—Å—ã:* –í–æ–∑–º–æ–∂–µ–Ω –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π –¥–æ—Ö–æ–¥. –ò–Ω—Ç—É–∏—Ü–∏—è –ø–æ–¥—Å–∫–∞–∂–µ—Ç –≤–µ—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.
*–ó–¥–æ—Ä–æ–≤—å–µ:* –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ (–¥–µ—Ç–æ–∫—Å, –º–µ–¥–∏—Ç–∞—Ü–∏—è) –ø–æ–ª–µ–∑–Ω—ã.

*–°–æ–≤–µ—Ç –¥–Ω—è:* –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–≤–æ—é —Å–∏–ª—É –º—É–¥—Ä–æ.
*–°—á–∞—Å—Ç–ª–∏–≤–æ–µ —á–∏—Å–ª–æ:* 8
*–°—á–∞—Å—Ç–ª–∏–≤—ã–π —Ü–≤–µ—Ç:* –ë–æ—Ä–¥–æ–≤—ã–π
""",
        "sagittarius": """
üèπ *‚ôêÔ∏è –°–¢–†–ï–õ–ï–¶ ‚Äî –ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ —Å–µ–≥–æ–¥–Ω—è*

*–û–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑:* –Æ–ø–∏—Ç–µ—Ä —Ä–∞—Å—à–∏—Ä—è–µ—Ç –≤–∞—à–∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç—ã. –°–µ–≥–æ–¥–Ω—è –∏–¥–µ–∞–ª—å–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π (—Ä–µ–∞–ª—å–Ω—ã—Ö –∏–ª–∏ –º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö).

*–õ—é–±–æ–≤—å:* –í—Å—Ç—Ä–µ—á–∞ —Å —á–µ–ª–æ–≤–µ–∫–æ–º –∏–∑ –¥—Ä—É–≥–æ–π –∫—É–ª—å—Ç—É—Ä—ã –∏–ª–∏ —Å–æ–≤–º–µ—Å—Ç–Ω–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ.
*–ö–∞—Ä—å–µ—Ä–∞:* –ù–æ–≤—ã–µ –ø—Ä–æ–µ–∫—Ç—ã –∏–ª–∏ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∏ –ø—Ä–∏–Ω–µ—Å—É—Ç —Ä–æ—Å—Ç. –î–µ–ª–∏—Ç–µ—Å—å –∑–Ω–∞–Ω–∏—è–º–∏.
*–§–∏–Ω–∞–Ω—Å—ã:* –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–ª–∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –æ–∫—É–ø—è—Ç—Å—è.
*–ó–¥–æ—Ä–æ–≤—å–µ:* –ê–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ –∑–∞—Ä—è–¥–∏—Ç —ç–Ω–µ—Ä–≥–∏–µ–π.

*–°–æ–≤–µ—Ç –¥–Ω—è:* –°—Ç—Ä–µ–º–∏—Ç–µ—Å—å –∫ –±–æ–ª—å—à–µ–º—É, –Ω–æ —Ü–µ–Ω–∏—Ç–µ –Ω–∞—Å—Ç–æ—è—â–µ–µ.
*–°—á–∞—Å—Ç–ª–∏–≤–æ–µ —á–∏—Å–ª–æ:* 3
*–°—á–∞—Å—Ç–ª–∏–≤—ã–π —Ü–≤–µ—Ç:* –§–∏–æ–ª–µ—Ç–æ–≤—ã–π
""",
        "capricorn": """
üêê *‚ôëÔ∏è –ö–û–ó–ï–†–û–ì ‚Äî –ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ —Å–µ–≥–æ–¥–Ω—è*

*–û–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑:* –°–∞—Ç—É—Ä–Ω –¥–∞—ë—Ç –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—É –∏ —Ü–µ–ª–µ—É—Å—Ç—Ä–µ–º–ª—ë–Ω–Ω–æ—Å—Ç—å. –°–µ–≥–æ–¥–Ω—è –≤—ã –º–æ–∂–µ—Ç–µ —Å–¥–µ–ª–∞—Ç—å —Å–µ—Ä—å—ë–∑–Ω—ã–π —à–∞–≥ –∫ —Ü–µ–ª–∏.

*–õ—é–±–æ–≤—å:* –û—Ç–Ω–æ—à–µ–Ω–∏—è, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –Ω–∞ —É–≤–∞–∂–µ–Ω–∏–∏ –∏ –æ–±—â–∏—Ö —Ü–µ–Ω–Ω–æ—Å—Ç—è—Ö, —É–∫—Ä–µ–ø–ª—è—é—Ç—Å—è.
*–ö–∞—Ä—å–µ—Ä–∞:* –¢—Ä—É–¥–æ–ª—é–±–∏–µ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ –ø—Ä–∏–∑–Ω–∞–Ω–∏—é. –í–æ–∑–º–æ–∂–Ω–æ –ø–æ–≤—ã—à–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.
*–§–∏–Ω–∞–Ω—Å—ã:* –•–æ—Ä–æ—à–∏–π –¥–µ–Ω—å –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ–Ω—Å–∏–∏.
*–ó–¥–æ—Ä–æ–≤—å–µ:* –†–µ–≥—É–ª—è—Ä–Ω—ã–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ —É–∫—Ä–µ–ø—è—Ç –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å.

*–°–æ–≤–µ—Ç –¥–Ω—è:* –î–≤–∏–≥–∞–π—Ç–µ—Å—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ, –Ω–æ —É–≤–µ—Ä–µ–Ω–Ω–æ.
*–°—á–∞—Å—Ç–ª–∏–≤–æ–µ —á–∏—Å–ª–æ:* 10
*–°—á–∞—Å—Ç–ª–∏–≤—ã–π —Ü–≤–µ—Ç:* –¢—ë–º–Ω–æ-—Å–∏–Ω–∏–π
""",
        "aquarius": """
‚ôíÔ∏è *‚ôíÔ∏è –í–û–î–û–õ–ï–ô ‚Äî –ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ —Å–µ–≥–æ–¥–Ω—è*

*–û–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑:* –£—Ä–∞–Ω –ø—Ä–∏–Ω–æ—Å–∏—Ç –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –∏–¥–µ–∏ –∏ –∏–Ω–Ω–æ–≤–∞—Ü–∏–∏. –°–µ–≥–æ–¥–Ω—è –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–æ–±—Ä–µ—Å—Ç–∏ —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ.

*–õ—é–±–æ–≤—å:* –ù–µ–æ–±—ã—á–Ω–æ–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∏–ª–∏ –æ–±—â–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å—ã.
*–ö–∞—Ä—å–µ—Ä–∞:* –ö–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –ø—Ä–∏–Ω–µ—Å—É—Ç —É—Å–ø–µ—Ö. –ë—É–¥—å—Ç–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã.
*–§–∏–Ω–∞–Ω—Å—ã:* –•–æ—Ä–æ—à–∏–π –¥–µ–Ω—å –¥–ª—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –≤ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏–ª–∏ –±–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.
*–ó–¥–æ—Ä–æ–≤—å–µ:* –ù–µ–æ–±—ã—á–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ (–∫—Ä–∏–æ—Ç–µ—Ä–∞–ø–∏—è, –ø–ª–∞–≤–∞–Ω–∏–µ) –ø–æ–ª–µ–∑–Ω—ã.

*–°–æ–≤–µ—Ç –¥–Ω—è:* –ë—É–¥—å—Ç–µ —Å–æ–±–æ–π, –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –∫–∞–∂–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–Ω—ã–º.
*–°—á–∞—Å—Ç–ª–∏–≤–æ–µ —á–∏—Å–ª–æ:* 11
*–°—á–∞—Å—Ç–ª–∏–≤—ã–π —Ü–≤–µ—Ç:* –ì–æ–ª—É–±–æ–π
""",
        "pisces": """
üê† *‚ôìÔ∏è –†–´–ë–´ ‚Äî –ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ —Å–µ–≥–æ–¥–Ω—è*

*–û–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑:* –ù–µ–ø—Ç—É–Ω —É—Å–∏–ª–∏–≤–∞–µ—Ç –≤–∞—à—É –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å –∏ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ. –°–µ–≥–æ–¥–Ω—è –¥–æ–≤–µ—Ä—è–π—Ç–µ —Å–Ω–∞–º –∏ –∏–Ω—Ç—É–∏—Ü–∏–∏.

*–õ—é–±–æ–≤—å:* –†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ –∏ –≥–ª—É–±–æ–∫–æ–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.
*–ö–∞—Ä—å–µ—Ä–∞:* –¢–≤–æ—Ä—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏ –ø—Ä–∏–Ω–µ—Å—É—Ç –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ. –ü–æ–º–æ—â—å –¥—Ä—É–≥–∏–º –±—É–¥–µ—Ç –æ—Ü–µ–Ω–µ–Ω–∞.
*–§–∏–Ω–∞–Ω—Å—ã:* –ò–Ω—Ç—É–∏—Ü–∏—è –ø–æ–¥—Å–∫–∞–∂–µ—Ç, –∫—É–¥–∞ –≤–ª–æ–∂–∏—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞. –ò–∑–±–µ–≥–∞–π—Ç–µ —Å–ø–µ–∫—É–ª—è—Ü–∏–π.
*–ó–¥–æ—Ä–æ–≤—å–µ:* –ú–µ–¥–∏—Ç–∞—Ü–∏—è, –º—É–∑—ã–∫–∞, –∞—Ä—Ç-—Ç–µ—Ä–∞–ø–∏—è –∏—Å—Ü–µ–ª—è—Ç –¥—É—à—É.

*–°–æ–≤–µ—Ç –¥–Ω—è:* –ü–ª—ã–≤–∏—Ç–µ –ø–æ —Ç–µ—á–µ–Ω–∏—é, –Ω–æ –Ω–µ —Ç–µ—Ä—è–π—Ç–µ —Å–≤—è–∑—å —Å —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é.
*–°—á–∞—Å—Ç–ª–∏–≤–æ–µ —á–∏—Å–ª–æ:* 12
*–°—á–∞—Å—Ç–ª–∏–≤—ã–π —Ü–≤–µ—Ç:* –ú–æ—Ä—Å–∫–∞—è –≤–æ–ª–Ω–∞
""",
    }
    
    # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç –≥–æ—Ä–æ—Å–∫–æ–ø–∞ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—â–∏–π
    horoscope = horoscope_texts.get(sign_key, f"""
‚ú® *{sign_name} ‚Äî –ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ —Å–µ–≥–æ–¥–Ω—è*

*–î–∞—Ç—ã:* {sign_dates}

*–û–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑:* –°–µ–≥–æ–¥–Ω—è –∑–≤–µ–∑–¥—ã –±–ª–∞–≥–æ–≤–æ–ª—è—Ç –≤–∞—à–µ–º—É –∑–Ω–∞–∫—É. –£–¥–µ–ª–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ —Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏—é –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é.

*–õ—é–±–æ–≤—å:* –û—Ç–∫—Ä—ã—Ç–æ–µ —Å–µ—Ä–¥—Ü–µ –ø—Ä–∏–≤–ª–µ—á—ë—Ç –Ω—É–∂–Ω—ã—Ö –ª—é–¥–µ–π.
*–ö–∞—Ä—å–µ—Ä–∞:* –ü—Ä–æ—è–≤–∏—Ç–µ —Ç–µ—Ä–ø–µ–Ω–∏–µ ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–æ—Ä–æ –ø–æ—è–≤—è—Ç—Å—è.
*–§–∏–Ω–∞–Ω—Å—ã:* –ò–∑–±–µ–≥–∞–π—Ç–µ –∏–º–ø—É–ª—å—Å–∏–≤–Ω—ã—Ö —Ç—Ä–∞—Ç.
*–ó–¥–æ—Ä–æ–≤—å–µ:* –ë–∞–ª–∞–Ω—Å —Ä–∞–±–æ—Ç—ã –∏ –æ—Ç–¥—ã—Ö–∞ ‚Äî –∑–∞–ª–æ–≥ —Ö–æ—Ä–æ—à–µ–≥–æ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏—è.

*–°–æ–≤–µ—Ç –¥–Ω—è:* –î–æ–≤–µ—Ä—è–π—Ç–µ —Å–≤–æ–µ–π –∏–Ω—Ç—É–∏—Ü–∏–∏.
*–°—á–∞—Å—Ç–ª–∏–≤–æ–µ —á–∏—Å–ª–æ:* 3
*–°—á–∞—Å—Ç–ª–∏–≤—ã–π —Ü–≤–µ—Ç:* –°–∏–Ω–∏–π
""")
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≥–æ—Ä–æ—Å–∫–æ–ø
    await callback.message.edit_text(horoscope, parse_mode="Markdown")
    
    # –ö–Ω–æ–ø–∫–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø–µ—Ä–∏–æ–¥–æ–≤
    builder = InlineKeyboardBuilder()
    builder.row(types.InlineKeyboardButton(text="üìÖ –ù–∞ –Ω–µ–¥–µ–ª—é", callback_data=f"horoscope_week_{sign_key}"))
    builder.row(types.InlineKeyboardButton(text="üìÜ –ù–∞ –º–µ—Å—è—Ü", callback_data=f"horoscope_month_{sign_key}"))
    builder.row(types.InlineKeyboardButton(text="üíù –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å", callback_data=f"horoscope_compat_{sign_key}"))
    builder.row(types.InlineKeyboardButton(text="‚ôàÔ∏è –î—Ä—É–≥–æ–π –∑–Ω–∞–∫", callback_data="horoscope_other"))
    
    await callback.message.answer("–•–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ?", reply_markup=builder.as_markup())
    await callback.answer()


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫ –≥–æ—Ä–æ—Å–∫–æ–ø–∞
@router.callback_query(F.data.startswith("horoscope_week_"))
async def show_weekly_horoscope(callback: CallbackQuery):
    """–ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ –Ω–µ–¥–µ–ª—é"""
    try:
        sign_key = callback.data.split("_")[-1]
        sign_data = ZODIAC_SIGNS.get(sign_key)
        if not sign_data:
            await callback.answer("‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∑–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞")
            return
        
        # –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –Ω–µ–¥–µ–ª—å–Ω–æ–≥–æ –≥–æ—Ä–æ—Å–∫–æ–ø–∞
        weekly_text = f"""
üìÖ *{sign_data['name']} ‚Äî –ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ –Ω–µ–¥–µ–ª—é*

*–û–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑:* –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –≤–∞—Å –∂–¥—É—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è. 
–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫-–≤—Ç–æ—Ä–Ω–∏–∫ ‚Äî –≤—Ä–µ–º—è –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è. 
–°—Ä–µ–¥–∞-—á–µ—Ç–≤–µ—Ä–≥ ‚Äî –∞–∫—Ç–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è. 
–ü—è—Ç–Ω–∏—Ü–∞-–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ ‚Äî –ø–æ–¥–≤–µ–¥–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤.

*–õ—é–±–æ–≤—å:* –í–æ–∑–º–æ–∂–Ω—ã –Ω–æ–≤—ã–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ –∏–ª–∏ —É–≥–ª—É–±–ª–µ–Ω–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–π.
*–ö–∞—Ä—å–µ—Ä–∞:* –ü—Ä–æ—è–≤–∏—Ç–µ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É ‚Äî –Ω–∞—á–∞–ª—å—Å—Ç–≤–æ –∑–∞–º–µ—Ç–∏—Ç –≤–∞—à–∏ —É—Å–∏–ª–∏—è.
*–§–∏–Ω–∞–Ω—Å—ã:* –ò–∑–±–µ–≥–∞–π—Ç–µ –∫—Ä—É–ø–Ω—ã—Ö —Ç—Ä–∞—Ç –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –Ω–µ–¥–µ–ª–∏.
*–ó–¥–æ—Ä–æ–≤—å–µ:* –°–ª–µ–¥–∏—Ç–µ –∑–∞ —Ä–µ–∂–∏–º–æ–º —Å–Ω–∞.

*–°–æ–≤–µ—Ç –Ω–µ–¥–µ–ª–∏:* –î–æ–≤–µ—Ä—è–π—Ç–µ –∏–Ω—Ç—É–∏—Ü–∏–∏, –Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ñ–∞–∫—Ç—ã.
"""
        await callback.message.edit_text(weekly_text, parse_mode="Markdown")
        await callback.answer()
    except Exception as e:
        await callback.answer("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≥–æ—Ä–æ—Å–∫–æ–ø–∞")


@router.callback_query(F.data.startswith("horoscope_month_"))
async def show_monthly_horoscope(callback: CallbackQuery):
    """–ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ –º–µ—Å—è—Ü"""
    try:
        sign_key = callback.data.split("_")[-1]
        sign_data = ZODIAC_SIGNS.get(sign_key)
        if not sign_data:
            await callback.answer("‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∑–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞")
            return
        
        # –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –º–µ—Å—è—á–Ω–æ–≥–æ –≥–æ—Ä–æ—Å–∫–æ–ø–∞
        monthly_text = f"""
üìÜ *{sign_data['name']} ‚Äî –ì–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ –º–µ—Å—è—Ü*

*–û–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑:* –≠—Ç–æ—Ç –º–µ—Å—è—Ü –ø—Ä–∏–Ω–µ—Å—ë—Ç –≤–∞–∂–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è. 
–ü–µ—Ä–≤–∞—è –¥–µ–∫–∞–¥–∞ ‚Äî –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ. 
–í—Ç–æ—Ä–∞—è –¥–µ–∫–∞–¥–∞ ‚Äî –∞–∫—Ç–∏–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞–Ω–æ–≤. 
–¢—Ä–µ—Ç—å—è –¥–µ–∫–∞–¥–∞ ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏.

*–õ—é–±–æ–≤—å:* –ì–ª—É–±–æ–∫–∏–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏—è –∏–ª–∏ –Ω–æ–≤—ã–µ —Å–µ—Ä—å—ë–∑–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è.
*–ö–∞—Ä—å–µ—Ä–∞:* –í–æ–∑–º–æ–∂–µ–Ω –∫–∞—Ä—å–µ—Ä–Ω—ã–π —Ä–æ—Å—Ç –∏–ª–∏ —Å–º–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
*–§–∏–Ω–∞–Ω—Å—ã:* –°—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥, –≤–æ–∑–º–æ–∂–Ω—ã –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è.
*–ó–¥–æ—Ä–æ–≤—å–µ:* –£–¥–µ–ª–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–µ, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –∫–æ–Ω—Ü–µ –º–µ—Å—è—Ü–∞.

*–°–æ–≤–µ—Ç –º–µ—Å—è—Ü–∞:* –ë—É–¥—å—Ç–µ –≥–∏–±–∫–∏–º–∏, –Ω–æ –Ω–µ –æ—Ç–∫–∞–∑—ã–≤–∞–π—Ç–µ—Å—å –æ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤.
"""
        await callback.message.edit_text(monthly_text, parse_mode="Markdown")
        await callback.answer()
    except Exception as e:
        await callback.answer("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≥–æ—Ä–æ—Å–∫–æ–ø–∞")


@router.callback_query(F.data.startswith("horoscope_compat_"))
async def show_compatibility(callback: CallbackQuery, state: FSMContext):
    """–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∑–Ω–∞–∫–æ–≤ –∑–æ–¥–∏–∞–∫–∞"""
    try:
        sign_key = callback.data.split("_")[-1]
        sign_data = ZODIAC_SIGNS.get(sign_key)
        if not sign_data:
            await callback.answer("‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∑–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞")
            return
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–µ—Ä–≤—ã–π –∑–Ω–∞–∫ –∏ –ø—Ä–æ—Å–∏–º –≤—ã–±—Ä–∞—Ç—å –≤—Ç–æ—Ä–æ–π
        await state.update_data(compat_first_sign=sign_key)
        
        builder = InlineKeyboardBuilder()
        for key, data in ZODIAC_SIGNS.items():
            builder.row(types.InlineKeyboardButton(
                text=data["name"], 
                callback_data=f"compat_with_{key}"
            ))
        
        await callback.message.edit_text(
            f"üíù *–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∑–Ω–∞–∫–æ–≤ –∑–æ–¥–∏–∞–∫–∞*\n\n"
            f"–í—ã–±—Ä–∞–Ω –∑–Ω–∞–∫: {sign_data['name']}\n"
            f"–¢–µ–ø–µ—Ä—å –≤—ã–±–µ—Ä–∏—Ç–µ –≤—Ç–æ—Ä–æ–π –∑–Ω–∞–∫ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:",
            reply_markup=builder.as_markup(),
            parse_mode="Markdown"
        )
        await callback.answer()
    except Exception as e:
        await callback.answer("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∑–Ω–∞–∫–∞")


@router.callback_query(F.data.startswith("compat_with_"))
async def show_compatibility_result(callback: CallbackQuery, state: FSMContext):
    """–ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏"""
    try:
        data = await state.get_data()
        first_sign_key = data.get("compat_first_sign")
        if not first_sign_key:
            await callback.answer("‚ùå –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–≤—ã–π –∑–Ω–∞–∫")
            return
        
        second_sign_key = callback.data.split("_")[-1]
        
        first_sign = ZODIAC_SIGNS.get(first_sign_key)
        second_sign = ZODIAC_SIGNS.get(second_sign_key)
        
        if not first_sign or not second_sign:
            await callback.answer("‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∑–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞")
            return
        
        # –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ (–∑–∞–≥–ª—É—à–∫–∞)
        compatibility_levels = ["‚≠êÔ∏è –ù–∏–∑–∫–∞—è", "‚≠êÔ∏è‚≠êÔ∏è –°—Ä–µ–¥–Ω—è—è", "‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è –í—ã—Å–æ–∫–∞—è", "‚ú® –ò–¥–µ–∞–ª—å–Ω–∞—è"]
        import random
        compat_level = random.choice(compatibility_levels)
        
        compat_text = f"""
üíù *–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∑–Ω–∞–∫–æ–≤ –∑–æ–¥–∏–∞–∫–∞*

*{first_sign['name']}* –∏ *{second_sign['name']}*

*–£—Ä–æ–≤–µ–Ω—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:* {compat_level}

*–õ—é–±–æ–≤—å:* {random.choice(["–ì–∞—Ä–º–æ–Ω–∏—á–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è", "–°—Ç—Ä–∞—Å—Ç—å, –Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã", "–î—Ä—É–∂–µ—Å–∫–∞—è –ª—é–±–æ–≤—å", "–ì–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ"])}
*–î—Ä—É–∂–±–∞:* {random.choice(["–û—Ç–ª–∏—á–Ω—ã–µ –¥—Ä—É–∑—å—è", "–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è", "–õ—É—á—à–∏–µ –¥—Ä—É–∑—å—è", "–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑–Ω–æ–≥–ª–∞—Å–∏—è"])}
*–†–∞–±–æ—Ç–∞:* {random.choice(["–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞", "–õ—É—á—à–µ —Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ", "–¢–≤–æ—Ä—á–µ—Å–∫–∏–π —Å–æ—é–∑", "–¢—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–º–ø—Ä–æ–º–∏—Å—Å"])}

*–°–æ–≤–µ—Ç:* {random.choice(["–£–≤–∞–∂–∞–π—Ç–µ —Ä–∞–∑–ª–∏—á–∏—è", "–ò—â–∏—Ç–µ –æ–±—â–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å—ã", "–î–æ–≤–µ—Ä—è–π—Ç–µ –¥—Ä—É–≥ –¥—Ä—É–≥—É", "–î–∞–≤–∞–π—Ç–µ —Å–≤–æ–±–æ–¥—É"])}
"""
        await callback.message.edit_text(compat_text, parse_mode="Markdown")
        await state.clear()
        await callback.answer()
    except Exception as e:
        await callback.answer("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á—ë—Ç–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏")


@router.callback_query(F.data == "horoscope_other")
async def choose_other_sign(callback: CallbackQuery):
    """–í—ã–±–æ—Ä –¥—Ä—É–≥–æ–≥–æ –∑–Ω–∞–∫–∞ –∑–æ–¥–∏–∞–∫–∞"""
    await callback.message.edit_text(
        "‚ôàÔ∏è *–í—ã–±–µ—Ä–∏—Ç–µ –∑–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞:*",
        reply_markup=get_zodiac_keyboard(),
        parse_mode="Markdown"
    )
    await callback.answer()


@router.message(lambda message: "." in message.text and len(message.text) <= 5)
async def process_birth_date(message: Message):
    """–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞–∫–∞ –∑–æ–¥–∏–∞–∫–∞ –ø–æ –¥–∞—Ç–µ —Ä–æ–∂–¥–µ–Ω–∏—è"""
    try:
        day_month = message.text.strip()
        day, month = map(int, day_month.split("."))
        
        # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞–∫–∞ –ø–æ –¥–∞—Ç–µ
        if (month == 3 and day >= 21) or (month == 4 and day <= 19):
            sign = "aries"
        elif (month == 4 and day >= 20) or (month == 5 and day <= 20):
            sign = "taurus"
        elif (month == 5 and day >= 21) or (month == 6 and day <= 20):
            sign = "gemini"
        elif (month == 6 and day >= 21) or (month == 7 and day <= 22):
            sign = "cancer"
        elif (month == 7 and day >= 23) or (month == 8 and day <= 22):
            sign = "leo"
        elif (month == 8 and day >= 23) or (month == 9 and day <= 22):
            sign = "virgo"
        elif (month == 9 and day >= 23) or (month == 10 and day <= 22):
            sign = "libra"
        elif (month == 10 and day >= 23) or (month == 11 and day <= 21):
            sign = "scorpio"
        elif (month == 11 and day >= 22) or (month == 12 and day <= 21):
            sign = "sagittarius"
        elif (month == 12 and day >= 22) or (month == 1 and day <= 19):
            sign = "capricorn"
        elif (month == 1 and day >= 20) or (month == 2 and day <= 18):
            sign = "aquarius"
        elif (month == 2 and day >= 19) or (month == 3 and day <= 20):
            sign = "pisces"
        else:
            await message.answer("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –¥–∞—Ç–∞! –í–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É –≤ —Ñ–æ—Ä–º–∞—Ç–µ –î–î.–ú–ú (–Ω–∞–ø—Ä–∏–º–µ—Ä, 15.09)")
            return
        
        sign_data = ZODIAC_SIGNS[sign]
        await message.answer(f"–í–∞—à –∑–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞: *{sign_data['name']}* ({sign_data['dates']})\n\n–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É /horoscope –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ–≥–Ω–æ–∑–∞.", parse_mode="Markdown")
        
    except (ValueError, KeyError):
        await message.answer("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç! –í–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É –≤ —Ñ–æ—Ä–º–∞—Ç–µ –î–î.–ú–ú (–Ω–∞–ø—Ä–∏–º–µ—Ä, 15.09)")